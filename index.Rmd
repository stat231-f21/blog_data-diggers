---
title: | 
  [![kickstarter](kickstarter.jpg){width=2in}](https://www.kickstarter.com/?ref=nav)
author: "Dan and Karla"
date: "November 30, 2021"
output:
  rmdformats::robobook:
    thumbnails: false
    highlight: "kate"
---


```{r setup, include = FALSE}
library(tidyverse)
library(kableExtra) # for example code; delete if not needed
library(tidytext)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(plotly)
library(gganimate)
library(gifski)
library(cowplot)

# Set code chunk defaults 
knitr::opts_chunk$set(echo = FALSE, 
                      mesage = FALSE,
                      warning = FALSE,
                      fig.align = "center")

# Set R environment options
options(knitr.kable.NA = '')
```

# Introduction

## Kickstarter 

Kickstarter, founded in 2009, is an online crowdfunding platform. Their mission is to help "bring creative projects to life" (Kickstarter, 2009) as individuals can create projects that draw others to support the process. 

Source: Kickstarter. (2009, April). _About_ https://www.kickstarter.com/about


# Success by State and Category

<!--- iframe allows for more customization than include_app(), doesn't cut off edges -->
<iframe src="https://ddachille23.shinyapps.io/MapGadgetApp/" height="700" width="720" style="border: 1px solid #464646;" data-external="1"></iframe>


# Text Analysis 

## Text Length and Outcome {.tabset .tabset-fade .tabset-pills}

```{r echo = FALSE}
# read in data
kickstarter <- read.csv("kickstarter_2020.csv")
# wrangle
text <- kickstarter %>%
  select(blurb, name, outcome, main_category)

small_data <- kickstarter %>%
  select(blurb, name)

# remove stop words 
data(stop_words)
wordcloud_data <- text %>%
   unnest_tokens(output = word, input = blurb) %>%
   anti_join(stop_words, by = "word")

# join text
new_text <- inner_join(wordcloud_data, small_data, by = "name")
```

### Name Length

```{r echo = FALSE}
# blurb length by outcome
length_data <- text %>% 
  mutate (blurb_length = nchar(blurb),
          name_length = nchar(name))
length_summary <- length_data %>% 
  group_by(outcome) %>% 
  summarise(mean_blurb_length = mean(blurb_length), n = n(),
            mean_name_length = round(mean(name_length), 1)) %>% 
  mutate(mean_blurb_length = round(mean_blurb_length, 1),
         outcome = as.factor(outcome))
# reorder levels of outcome factor
length_summary$outcome <- factor(length_summary$outcome, levels=rev(levels(length_summary$outcome)))

# name length plot
ggplot(length_summary, aes(x = mean_name_length, y = outcome)) + 
  geom_bar(stat = "identity", aes(fill = outcome)) +
  theme_minimal() + labs(x = "Mean Name Length (characters)", y = "Outcome", title = "Name Length by Outcome") + 
  geom_label(aes(label = mean_name_length)) +
  scale_fill_manual(values=c("#05ce78", "#ed4752")) +
  theme(legend.position = "none")
```


### Blurb Length

```{r echo = FALSE}
# blurb length plot
ggplot(length_summary, aes(x = mean_blurb_length, y = outcome)) + 
  geom_bar(stat = "identity", aes(fill = outcome)) +
  theme_minimal() + labs(x = "Mean Blurb Length (characters)", y = "Outcome", title = "Blurb Length by Outcome") + 
  geom_label(aes(label = mean_blurb_length)) +
  scale_fill_manual(values=c("#05ce78", "#ed4752")) +
  theme(legend.position = "none")

```


## Sentiment Analysis {.tabset .tabset-fade .tabset-pills}

### Bing Lexicon

```{r echo = FALSE, message = FALSE}
# using bing lexicon (pos or neg)
bing <- get_sentiments("bing")

# join in bing and get blurb length
blurb_sentiment <- new_text %>% 
  inner_join(bing) 

# creating sentiment score
tt_bing <- blurb_sentiment %>% 
  group_by(name, outcome) %>% 
  summarize(sentiment_score = sum(sentiment == "positive") - sum(sentiment == "negative"),
            tPos = sum(sentiment == "positive"), tNeg = sum(sentiment == "negative"))
# make table
bing_tbl <- tt_bing %>% 
  group_by(outcome) %>% 
  summarise(mean_sent_score = mean(sentiment_score),
            sd = sd(sentiment_score),
            median = median(sentiment_score))
bing_tbl_pretty <- bing_tbl %>% 
  mutate(mean_sent_score = round(mean_sent_score, 3)) %>% 
  select(outcome, mean_sent_score) %>% 
  rename(Outcome = outcome, 
         "Mean Sentiment Score" = mean_sent_score) %>% 
  kbl() %>%
  kable_material("hover")

# sentiment score faceted plot
ggplot(data = tt_bing, aes(x = sentiment_score, fill = outcome)) + 
  geom_histogram(bins = 15) +
  facet_grid(~outcome) + 
  labs(title = "Sentiment Score by Outcome", x = "Sentiment Score (Bing lexicon)") + 
  scale_fill_manual(values = c("#ed4752", "#05ce78")) +
  theme_bw() +
  theme(legend.position = "none") 
bing_tbl_pretty
```

### Afinn Lexicon

```{r echo = FALSE, message = FALSE}
# using afinn lexicon
afinn <- get_sentiments("afinn")

blurb_sentiment_fin <- new_text %>% 
  inner_join(afinn)

# get sentiment score
tt_afinn <- blurb_sentiment_fin %>% 
  group_by(name, outcome) %>% 
  summarize(sentiment_score = sum(value))

# make table
afinn_tbl <- tt_afinn %>% 
  group_by(outcome) %>% 
  summarise(mean_sent_score = mean(sentiment_score),
            sd = sd(sentiment_score),
            median = median(sentiment_score)) 
afinn_tbl_pretty <- afinn_tbl %>% 
  mutate(mean_sent_score = round(mean_sent_score, 3)) %>% 
  select(outcome, mean_sent_score) %>% 
  rename(Outcome = outcome, 
         "Mean Sentiment Score" = mean_sent_score) %>% 
  kbl() %>%
  kable_material("hover")


# sentiment score faceted plot
ggplot(data = tt_afinn, aes(x = sentiment_score, fill = outcome)) + 
  geom_histogram(bins = 15) +
  facet_grid(~outcome) + 
  labs(title = "Sentiment Score by Outcome", x = "Sentiment Score (Afinn lexicon)") + 
  scale_fill_manual(values = c("#ed4752", "#05ce78")) +
  theme_bw() +
  theme(legend.position = "none") 
afinn_tbl_pretty
```


## Word Cloud

<iframe src="https://ddachille23.shinyapps.io/WordCloudApp/" height="780" width="720" style="border: 1px solid #464646;" data-external="1"></iframe>


# Project Launch Analysis

This section focuses on the launching process of a Kickstarter project. We aim to examine the trends of successful projects through 2009-2020 based on launch month, launch day, success rates throughout the years, and campaign length. 

## Launch Month and Success Rate

#### What is the best month to launch a project?

```{r}
# wrangling
date_data <- kickstarter %>%
  select(c("launched_at", "outcome", "proportion_funded", "pct_funded", "campaign_length")) %>%
  separate(launched_at, c("date", "time"), sep = " ") %>%
  mutate(month = months(as.Date(date)),
         day = weekdays(as.Date(date)),
         year = year(as.Date(date))) 
# dataset for month
month_data <- date_data %>%
  group_by(month) %>%
  summarise(n = n(),
            success_rate = sum(outcome=="successful")/n)
# creating bar plot
p2 <- month_data %>%
  ggplot(aes(x = month, y = success_rate)) +
  geom_bar(stat = "identity", fill = "#05ce78") + coord_flip() +
  labs(title = "Kickstarter Projects by Launch Month", 
       x = "Month",
       y = "Success Rate") +
  scale_x_discrete(limits = rev(c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"))) +
  theme_minimal()
p2
```


## Launch Day and Success Rate

#### What is the best day to launch a project?

```{r}
#dataset for day
day_data <- date_data %>%
  group_by(day) %>%
  summarise(n = n(),
            success_rate = sum(outcome=="successful")/n) 
# day barplot
ggplot(data = day_data, aes(x = day, y = success_rate)) +
  geom_bar(stat = "identity", fill = "#05ce78") +
  labs(title = "Kickstarter Projects by Launch Day",
       x = "Day",
       y = "Success Rate") +
  scale_x_discrete(limits = c("Sunday", "Monday", "Tuesday", "Wednesday",
                              "Thursday", "Friday", "Saturday")) +
  theme_minimal()
```

## Trend in Success Rate 2009-2020

```{r}
# dataset for year
year_data <- date_data %>%
  group_by(year) %>%
  summarise(n = n(),
            success_rate = sum(outcome=="successful")/n) 

# creating line plot for year 
gif_plot_year <- ggplot(year_data, aes(x = year, y = success_rate)) +
  geom_line(color = "#05ce78") + geom_point() +
  labs(title = "Trend in Outcome of Kickstarter Projects by Year",
       x = "Year",
       y = "Success Rate") +
  transition_reveal(year) +
  theme_minimal()

# saving line plot into a gif
animate(gif_plot_year, duration = 6, fps = 40, width = 400, height = 300, renderer = gifski_renderer())
anim_save("line-plot.gif")

```


## Campaign Length and Success Rate {.tabset .tabset-fade .tabset-pills}

From 2009-2011, Kickstarter creators were able to set campaign lengths of up to 90 days. However, in 2011, Kickstarter claimed that through their own research, they found that projects lasting longer than 60 days were less successful than projects with shorter campaign lengths, Thus, after 2011, campaign lengths were recommended to be at most 30-60 days. 

In this section, we analyze the validity of Kickstarter's findings: Do shorter campaign lengths correlate with higher success rates on Kickstarter projects? 

### 2011

```{r, message = FALSE}
# dataset for campaign length (2011)
camplength1 <- date_data %>%
  group_by(campaign_length, year) %>%
  filter(year == 2011) %>%
  summarise(n = n(),
            success_rate = sum(outcome=="successful")/n) 

# plot for campaign length 2011
ggplot(camplength1, aes(x = campaign_length, y = success_rate, size = n)) +
  geom_smooth(method = "glm", color = "#05ce78") + geom_point() +
  labs(title = "Success of Kickstarter Projects from Campaign Length (2009-2011)",
       x = "Campaign Length (in days)",
       y = "Success Rate") +
  theme_minimal()
```

### 2012-2020

```{r, message = FALSE}
# for 2012-2020
camplength2 <- date_data %>%
  group_by(campaign_length, year) %>%
  filter(year > 2011, campaign_length <= 60) %>%
  summarise(n = n(),
            success_rate = sum(outcome=="successful")/n) 

# plot for campaign length 2012-2020
ggplot(camplength2, aes(x = campaign_length, y = success_rate, size = n)) +
  geom_smooth(method = "glm", color = "#05ce78") + geom_point() +
  labs(title = "Success of Kickstarter Projects from Campaign Length (2011-2020)",
       x = "Campaign Length (in days)",
       y = "Success Rate") +
  facet_wrap(~ year) +
  theme_minimal()
```



